<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI-Powered Data Entry Automation for CRM Systems: A Technical Walkthrough | B2B Vic</title>
    <meta name="description" content="How to build AI-powered data entry automation for CRM systems — browser automation, API integration, validation layers, and error handling for autonomous CRM management." />
    <meta name="author" content="Victor Valentine Romo" />
    <meta property="og:title" content="AI-Powered Data Entry Automation for CRM Systems: A Technical Walkthrough" />
    <meta property="og:description" content="How to build AI-powered data entry automation for CRM systems — browser automation, API integration, validation layers, and error handling for autonomous CRM management." />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://b2bvic.com/articles/ai-data-entry-automation.html" />
    <meta property="og:site_name" content="B2B Vic" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="AI-Powered Data Entry Automation for CRM Systems: A Technical Walkthrough" />
    <meta name="twitter:description" content="How to build AI-powered data entry automation for CRM systems — browser automation, API integration, validation layers, and error handling for autonomous CRM management." />
    <link rel="canonical" href="https://b2bvic.com/articles/ai-data-entry-automation.html" />

    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%230a0a0a' width='100' height='100' rx='12'/><text x='50' y='70' font-family='sans-serif' font-size='38' font-weight='700' fill='%23d97706' text-anchor='middle'>VVR</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;500;600;700&family=DM+Sans:wght@400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              base: '#0a0a0a',
              surface: { DEFAULT: '#171717', overlay: '#262626' },
              accent: { DEFAULT: '#d97706', light: '#f59e0b' },
              zinc: {
                50: '#fafafa', 100: '#f4f4f5', 200: '#e4e4e7', 300: '#d4d4d8',
                400: '#a1a1aa', 500: '#71717a', 600: '#52525b', 700: '#3f3f46',
                800: '#27272a', 900: '#18181b', 950: '#09090b'
              }
            },
            fontFamily: {
              display: ['Sora', 'system-ui', '-apple-system', 'sans-serif'],
              body: ['Sora', 'system-ui', '-apple-system', 'sans-serif'],
              mono: ['IBM Plex Mono', 'ui-monospace', 'monospace']
            }
          }
        }
      }
    </script>
    <link rel="me" href="https://scalewithsearch.com" />
    <link rel="me" href="https://victorvalentineromo.com" />
    <link rel="me" href="https://aifirstsearch.com" />
    <link rel="me" href="https://browserprompt.com" />
    <link rel="me" href="https://creatinepedia.com" />
    <link rel="me" href="https://polytraffic.com" />
    <link rel="me" href="https://tattooremovalnear.com" />
    <link rel="me" href="https://comicstripai.com" />
    <link rel="me" href="https://b2bvic.com" />
    <link rel="me" href="https://aipaypercrawl.com" />
    <link rel="me" href="https://seobyrole.com" />
    <link rel="me" href="https://quickfixseo.com" />
    <style>

    /* Mega menu */
    .mega-panel { transition: opacity 0.15s ease, visibility 0.15s ease; }
    .mega-panel.hidden { opacity: 0; visibility: hidden; display: none; }
    .mega-panel:not(.hidden) { opacity: 1; visibility: visible; display: block; }
    .mega-link {
      display: block; padding: 6px 0;
      font-size: 0.875rem; color: #a1a1aa;
      transition: color 0.15s;
    }
    .mega-link:hover { color: #fafafa; text-decoration: none; }
    .mega-view-all {
      display: inline-block; margin-top: 12px;
      font-size: 0.8125rem; font-weight: 500;
      color: #d97706; transition: color 0.15s;
    }
    .mega-view-all:hover { color: #f59e0b; text-decoration: none; }

    /* Nav effects */
    .nav-link { position: relative; }
    .nav-link::after {
      content: ''; position: absolute; bottom: -2px; left: 0;
      width: 0; height: 1px; background: #d97706; transition: width 0.3s ease;
    }
    .nav-link:hover::after { width: 100%; }
    .cta-glow { position: relative; }
    .cta-glow::before {
      content: ''; position: absolute; inset: -2px;
      background: linear-gradient(135deg, #f59e0b, #d97706);
      border-radius: inherit; opacity: 0; filter: blur(12px);
      transition: opacity 0.3s ease; z-index: -1;
    }
    .cta-glow:hover::before { opacity: 0.5; }

    /* Active trigger state */
    .mega-trigger[aria-expanded="true"] { color: #fafafa; }
    .mega-trigger[aria-expanded="true"] svg { transform: rotate(180deg); }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #0a0a0a; }
    ::-webkit-scrollbar-thumb { background: #27272a; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #3f3f46; }

    /* Article prose overrides for dark theme */
    .prose-dark h1, .prose-dark h2, .prose-dark h3, .prose-dark h4 { color: #fafafa; }
    .prose-dark p, .prose-dark li, .prose-dark td, .prose-dark th { color: #a1a1aa; }
    .prose-dark strong { color: #fafafa; }
    .prose-dark a { color: #d97706; }
    .prose-dark a:hover { color: #f59e0b; }
    .prose-dark blockquote { border-left-color: #d97706; background: #171717; padding: 1rem 1.5rem; border-radius: 0 0.5rem 0.5rem 0; }
    .prose-dark blockquote p { color: #a1a1aa; }
    .prose-dark code { background: #171717; color: #f59e0b; padding: 0.15em 0.4em; border-radius: 0.25rem; font-size: 0.875em; }
    .prose-dark pre { background: #171717; border: 1px solid #27272a; border-radius: 0.5rem; }
    .prose-dark pre code { background: transparent; color: #a1a1aa; padding: 0; }
    .prose-dark hr { border-color: #27272a; }
    .prose-dark ul { list-style-type: disc; }
    .prose-dark ol { list-style-type: decimal; }
    .prose-dark table { border-collapse: collapse; }
    .prose-dark th { border-bottom: 2px solid #27272a; padding: 0.75rem; text-align: left; }
    .prose-dark td { border-bottom: 1px solid #27272a; padding: 0.75rem; }
    .prose-dark img { border-radius: 0.5rem; }

    </style>
    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Article",
      "headline": "AI-Powered Data Entry Automation for CRM Systems: A Technical Walkthrough",
      "description": "How to build AI-powered data entry automation for CRM systems — browser automation, API integration, validation layers, and error handling for autonomous CRM management.",
      "author": {
        "@type": "Person",
        "name": "Victor Valentine Romo",
        "url": "https://victorvalentineromo.com",
        "jobTitle": "Fractional SEO Consultant",
        "sameAs": [
          "https://scalewithsearch.com",
          "https://victorvalentineromo.com",
          "https://aifirstsearch.com",
          "https://browserprompt.com",
          "https://creatinepedia.com",
          "https://polytraffic.com",
          "https://tattooremovalnear.com",
          "https://comicstripai.com",
          "https://b2bvic.com",
          "https://aipaypercrawl.com",
          "https://seobyrole.com",
          "https://quickfixseo.com"
        ]
      },
      "publisher": {
        "@type": "Organization",
        "name": "B2B Vic",
        "url": "https://b2bvic.com"
      },
      "datePublished": "2026-02-07",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://b2bvic.com/articles/ai-data-entry-automation.html"
      }
    },
    {
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://b2bvic.com/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Writing",
          "item": "https://b2bvic.com/articles.html"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "AI-Powered Data Entry Automation for CRM Systems: A Technical Walkthrough"
        }
      ]
    }
  ]
}
    </script>
</head>
<body class="bg-[#0a0a0a] text-zinc-400 antialiased font-body">


  <nav class="fixed top-0 left-0 right-0 z-50 border-b border-zinc-800/60 bg-[#0a0a0a]/95 backdrop-blur-md">
    <div class="max-w-6xl mx-auto">
      <div class="flex items-center justify-between h-16 px-6">
        <!-- Logo -->
        <a href="/" class="flex items-center gap-2 group">
          <span class="font-display font-700 text-xl tracking-tight text-amber-500 group-hover:text-amber-400 transition-colors">b2bvic</span>
        </a>

        <!-- Desktop Nav -->
        <div class="hidden lg:flex items-center gap-1">

          <!-- Writing dropdown -->
          <div class="relative" data-mega="writing">
            <button class="mega-trigger nav-link px-4 py-2 text-sm text-zinc-400 hover:text-zinc-200 transition-colors flex items-center gap-1 font-body font-500">
              Writing
              <svg class="w-3 h-3 opacity-50 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </button>
          </div>

          <!-- Services dropdown -->
          <div class="relative" data-mega="services">
            <button class="mega-trigger nav-link px-4 py-2 text-sm text-zinc-400 hover:text-zinc-200 transition-colors flex items-center gap-1 font-body font-500">
              Services
              <svg class="w-3 h-3 opacity-50 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </button>
          </div>

          <!-- Case Studies (direct link) -->
          <a href="/case-studies.html" class="nav-link px-4 py-2 text-sm text-zinc-400 hover:text-zinc-200 transition-colors font-body font-500">Case Studies</a>

          <!-- About (direct link) -->
          <a href="/about.html" class="nav-link px-4 py-2 text-sm text-zinc-400 hover:text-zinc-200 transition-colors font-body font-500">About</a>

          <div class="w-px h-4 bg-zinc-800 mx-2"></div>

          <!-- CTA -->
          <a href="/services.html#contact" class="px-5 py-2 text-sm font-semibold bg-amber-600 hover:bg-amber-500 text-white rounded-md transition-colors cta-glow font-display">Work With Me</a>
        </div>

        <!-- Mobile menu button -->
        <button id="mobile-menu-btn" aria-label="Open menu" class="lg:hidden p-2 text-zinc-400 hover:text-zinc-200">
          <svg id="menu-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
          <svg id="close-icon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </button>
      </div>

      <!-- MEGA PANEL: Writing -->
      <div id="mega-writing" class="mega-panel hidden border-t border-zinc-800/60 bg-[#0a0a0a]">
        <div class="max-w-6xl mx-auto px-6 py-8">
          <div class="grid grid-cols-4 gap-8">
            <div>
              <div class="flex items-center gap-2 mb-4">
                <span class="text-xs font-semibold tracking-wider text-zinc-500 uppercase">SEO Strategy</span>
              </div>
              <div class="space-y-1">
                <a href="/articles/why-fractional-seo-beats-agencies.html" class="mega-link">Fractional vs Agencies</a>
                <a href="/articles/why-your-seo-audit-failed.html" class="mega-link">Why SEO Audits Fail</a>
                <a href="/articles/enterprise-seo-audit-4-hour-framework.html" class="mega-link">4-Hour Enterprise Audit</a>
                <a href="/articles/saas-seo-url-architecture-subdomains-subdirectories.html" class="mega-link">SaaS URL Architecture</a>
              </div>
            </div>
            <div>
              <div class="flex items-center gap-2 mb-4">
                <span class="text-xs font-semibold tracking-wider text-zinc-500 uppercase">AI Systems</span>
              </div>
              <div class="space-y-1">
                <a href="/articles/ai-prompt-engineering-seo.html" class="mega-link">AI Prompt Engineering for SEO</a>
                <a href="/articles/local-llm-deployment-enterprise-marketing.html" class="mega-link">Local LLM Deployment</a>
                <a href="/articles/observer-protocol-ai-content-voice-homogenization.html" class="mega-link">Observer Protocol</a>
              </div>
            </div>
            <div>
              <div class="flex items-center gap-2 mb-4">
                <span class="text-xs font-semibold tracking-wider text-zinc-500 uppercase">Business Growth</span>
              </div>
              <div class="space-y-1">
                <a href="/articles/real-estate-seo-systems-database-driven-leads.html" class="mega-link">Database-Driven SEO</a>
                <a href="/articles/google-business-profile-multi-location-local-seo.html" class="mega-link">Multi-Location Local SEO</a>
                <a href="/articles/platform-seo-user-generated-content-scale.html" class="mega-link">Platform SEO at Scale</a>
              </div>
            </div>
            <div>
              <a href="/articles.html" class="mega-view-all">All articles &rarr;</a>
            </div>
          </div>
        </div>
      </div>

      <!-- MEGA PANEL: Services -->
      <div id="mega-services" class="mega-panel hidden border-t border-zinc-800/60 bg-[#0a0a0a]">
        <div class="max-w-6xl mx-auto px-6 py-8">
          <div class="grid grid-cols-4 gap-8">
            <div>
              <a href="/services.html#fractional" class="block group">
                <p class="text-sm font-semibold text-zinc-200 group-hover:text-amber-400 transition-colors">Fractional SEO Leadership</p>
                <p class="text-xs text-zinc-500 mt-1">$8,000/mo &middot; 10 hrs/mo</p>
                <p class="text-xs text-zinc-600 mt-2">Senior strategic oversight embedded in your team. 6-month minimum.</p>
              </a>
            </div>
            <div>
              <a href="/services.html#knowledge" class="block group">
                <p class="text-sm font-semibold text-zinc-200 group-hover:text-amber-400 transition-colors">AI Knowledge Systems</p>
                <p class="text-xs text-zinc-500 mt-1">$5,000 one-time</p>
                <p class="text-xs text-zinc-600 mt-2">Custom AI memory architecture for your team's workflows.</p>
              </a>
            </div>
            <div>
              <a href="/services.html#sites" class="block group">
                <p class="text-sm font-semibold text-zinc-200 group-hover:text-amber-400 transition-colors">Site Builds</p>
                <p class="text-xs text-zinc-500 mt-1">From $5,000</p>
                <p class="text-xs text-zinc-600 mt-2">SEO-native static sites engineered for topical authority.</p>
              </a>
            </div>
            <div>
              <a href="/services.html#consulting" class="block group">
                <p class="text-sm font-semibold text-zinc-200 group-hover:text-amber-400 transition-colors">Consulting</p>
                <p class="text-xs text-zinc-500 mt-1">$200/hr</p>
                <p class="text-xs text-zinc-600 mt-2">Strategy sessions, audits, second opinions. No commitment.</p>
              </a>
            </div>
          </div>
          <div class="mt-6 pt-4 border-t border-zinc-800/40">
            <a href="/services.html" class="text-sm text-amber-500 hover:text-amber-400 font-medium transition-colors">View all services &rarr;</a>
          </div>
        </div>
      </div>

      <!-- Mobile Menu -->
      <div id="mobile-menu" class="hidden lg:hidden border-t border-zinc-800 bg-[#0a0a0a] max-h-[80vh] overflow-y-auto">
        <div class="px-6 py-4 space-y-1">
          <button class="mobile-section-toggle w-full flex items-center justify-between py-3 text-zinc-200 font-medium">
            Writing
            <svg class="w-4 h-4 text-zinc-600 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
          </button>
          <div class="mobile-section hidden pl-4 pb-3 space-y-1">
            <a href="/articles/why-fractional-seo-beats-agencies.html" class="block py-1.5 text-sm text-zinc-400 hover:text-white">Fractional vs Agencies</a>
            <a href="/articles/enterprise-seo-audit-4-hour-framework.html" class="block py-1.5 text-sm text-zinc-400 hover:text-white">4-Hour Enterprise Audit</a>
            <a href="/articles/ai-prompt-engineering-seo.html" class="block py-1.5 text-sm text-zinc-400 hover:text-white">AI Prompt Engineering for SEO</a>
            <a href="/articles.html" class="block py-1.5 text-sm text-amber-500 font-medium">All articles &rarr;</a>
          </div>

          <button class="mobile-section-toggle w-full flex items-center justify-between py-3 text-zinc-200 font-medium">
            Services
            <svg class="w-4 h-4 text-zinc-600 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
          </button>
          <div class="mobile-section hidden pl-4 pb-3 space-y-1">
            <a href="/services.html#fractional" class="block py-1.5 text-sm text-zinc-400 hover:text-white">Fractional SEO &middot; $8K/mo</a>
            <a href="/services.html#knowledge" class="block py-1.5 text-sm text-zinc-400 hover:text-white">AI Knowledge Systems &middot; $5K</a>
            <a href="/services.html#sites" class="block py-1.5 text-sm text-zinc-400 hover:text-white">Site Builds &middot; $5K+</a>
            <a href="/services.html#consulting" class="block py-1.5 text-sm text-zinc-400 hover:text-white">Consulting &middot; $200/hr</a>
            <a href="/services.html" class="block py-1.5 text-sm text-amber-500 font-medium">All services &rarr;</a>
          </div>

          <a href="/case-studies.html" class="block py-3 text-zinc-200 font-medium">Case Studies</a>
          <a href="/about.html" class="block py-3 text-zinc-200 font-medium">About</a>

          <a href="/services.html#contact" class="block mt-4 py-3 bg-amber-600 text-white text-center font-semibold rounded-lg">Work With Me</a>
        </div>
      </div>
    </div>
  </nav>

    <!-- Spacer for fixed nav -->
    <div class="h-16"></div>

    <!-- Breadcrumbs -->
    <div class="max-w-3xl mx-auto px-6 pt-8 pb-4">
      <nav class="text-xs text-zinc-600">
        <a href="/" class="hover:text-zinc-400 transition-colors">Home</a>
        <span class="mx-2">/</span>
        <a href="/articles.html" class="hover:text-zinc-400 transition-colors">Writing</a>
        <span class="mx-2">/</span>
        <span class="text-zinc-500">AI-Powered Data Entry Automation for CRM Systems: A Technical Walkthrough</span>
      </nav>
    </div>

    <!-- Article -->
    <main class="max-w-3xl mx-auto px-6 pb-20">
        <article class="prose-dark">
            <h1 class="text-3xl md:text-4xl font-display font-700 text-[#fafafa] leading-tight mb-8">AI-Powered Data Entry Automation for CRM Systems: A Technical Walkthrough</h1>
            <div class="flex items-center gap-4 mb-12 text-sm text-zinc-600">
              <span>Victor Valentine Romo</span>
              <span class="text-zinc-800">&middot;</span>
              <time datetime="2026-02-07">2026-02-07</time>
            </div>
            <div class="space-y-6 leading-relaxed text-base">
            <h1>AI-Powered Data Entry Automation for CRM Systems: A Technical Walkthrough</h1>
<p>CRM data entry consumes 8-12 hours per week for the average B2B sales team. Sales reps manually log call notes, update deal stages, create contact records from business cards and email signatures, and enrich records with company data pulled from LinkedIn, company websites, and prospecting tools. The work is necessary — clean CRM data drives pipeline forecasting, marketing automation, and sales analytics. It&#39;s also mind-numbing, error-prone, and a catastrophic misuse of skilled labor.</p>
<p>AI-powered data entry automation eliminates 70-90% of manual CRM work. AI agents extract contact information from unstructured sources (emails, meeting transcripts, LinkedIn profiles), validate and enrich the data, and write it to the CRM via API or <a href="/articles/browser-automation-ai-tools.html">browser automation</a>. The human role shifts from data entry to data supervision — reviewing flagged edge cases and approving batch updates rather than typing individual fields.</p>
<p>This article is a technical walkthrough of building AI data entry automation for CRM systems. It covers extraction workflows, validation logic, API integration patterns, browser automation for systems without APIs, and error handling that prevents garbage data from polluting your CRM. The implementation is based on production systems handling 500+ contact updates per week across <strong>HubSpot</strong>, <strong>Salesforce</strong>, and <strong>Follow Up Boss</strong>.</p>
<h2>The Three Automation Layers</h2>
<p>AI data entry automation operates in three layers:</p>
<p><strong>Layer 1: Extraction</strong> — Pull unstructured data from sources (emails, transcripts, web pages, PDFs)
<strong>Layer 2: Validation</strong> — Verify data quality, check for duplicates, flag low-confidence matches
<strong>Layer 3: Write</strong> — Insert or update CRM records via API or browser automation</p>
<p>Each layer requires different tools and error-handling logic.</p>
<h2>Layer 1: Extraction Workflows</h2>
<p>Extraction converts unstructured text into structured data that CRM systems can accept.</p>
<h3>Workflow 1: Email Signature Extraction</h3>
<p><strong>Input:</strong> Incoming emails from prospects, clients, referral partners
<strong>Output:</strong> Contact record with name, title, company, phone, email, LinkedIn URL</p>
<p><strong>AI prompt:</strong></p>
<blockquote>
<p>Extract contact information from this email signature. Return JSON with fields: first_name, last_name, title, company, phone, email, linkedin_url. If a field is missing, return null. Do not guess or fabricate.</p>
<p>Email signature:
[paste signature text]</p>
</blockquote>
<p><strong>Example output:</strong></p>
<pre><code class="language-json">{
  &quot;first_name&quot;: &quot;Sarah&quot;,
  &quot;last_name&quot;: &quot;Chen&quot;,
  &quot;title&quot;: &quot;VP of Marketing&quot;,
  &quot;company&quot;: &quot;Acme SaaS Inc.&quot;,
  &quot;phone&quot;: &quot;+1-415-555-0123&quot;,
  &quot;email&quot;: &quot;sarah.chen@acmesaas.com&quot;,
  &quot;linkedin_url&quot;: &quot;linkedin.com/in/sarahchen&quot;
}
</code></pre>
<p><strong>Automation:</strong> Email forwarding rule triggers AI extraction → outputs to validation queue</p>
<p><strong>Tools:</strong> <strong>Gmail API</strong> + <strong>Claude</strong> for extraction, <strong>Airtable</strong> or <strong>Google Sheets</strong> as validation queue</p>
<h3>Workflow 2: Meeting Transcript Enrichment</h3>
<p><strong>Input:</strong> Transcripts from <strong>Zoom</strong>, <strong>Google Meet</strong>, <strong>Otter.ai</strong>
<strong>Output:</strong> Contact updates (deal stage changes, pain points mentioned, next steps logged)</p>
<p><strong>AI prompt:</strong></p>
<blockquote>
<p>Analyze this sales call transcript. Extract:</p>
<ul>
<li>Deal stage (Discovery, Demo Scheduled, Proposal Sent, Negotiation, Closed-Won, Closed-Lost)</li>
<li>Pain points mentioned by prospect</li>
<li>Next steps agreed upon</li>
<li>Budget mentioned (if any)</li>
<li>Decision timeline (if any)
Return JSON.</li>
</ul>
</blockquote>
<p><strong>Example output:</strong></p>
<pre><code class="language-json">{
  &quot;deal_stage&quot;: &quot;Proposal Sent&quot;,
  &quot;pain_points&quot;: [&quot;Manual data entry consuming 15 hours/week&quot;, &quot;CRM data quality issues affecting reporting&quot;],
  &quot;next_steps&quot;: &quot;Send proposal by Friday, follow up call scheduled for next Tuesday&quot;,
  &quot;budget&quot;: &quot;$50,000 annual&quot;,
  &quot;decision_timeline&quot;: &quot;Q2 2026&quot;
}
</code></pre>
<p><strong>Automation:</strong> Meeting transcript → AI extraction → CRM API updates deal record</p>
<p><strong>Tools:</strong> <strong>Otter.ai API</strong> or <strong>Zoom transcript export</strong> + <strong>Claude</strong> + <strong>HubSpot/Salesforce API</strong></p>
<h3>Workflow 3: LinkedIn Profile Enrichment</h3>
<p><strong>Input:</strong> LinkedIn profile URL
<strong>Output:</strong> Contact enrichment (current title, company, employment history, education)</p>
<p><strong>AI prompt:</strong></p>
<blockquote>
<p>Scrape this LinkedIn profile and extract professional data. Return JSON with: current_title, current_company, previous_companies (array), education (array), location, profile_summary.</p>
</blockquote>
<p><strong>Example output:</strong></p>
<pre><code class="language-json">{
  &quot;current_title&quot;: &quot;Director of Sales Operations&quot;,
  &quot;current_company&quot;: &quot;TechCorp&quot;,
  &quot;previous_companies&quot;: [&quot;SalesCo (Senior Sales Ops Manager)&quot;, &quot;StartupXYZ (Sales Ops Analyst)&quot;],
  &quot;education&quot;: [&quot;MBA - Stanford GSB&quot;, &quot;BS Computer Science - UC Berkeley&quot;],
  &quot;location&quot;: &quot;San Francisco Bay Area&quot;,
  &quot;profile_summary&quot;: &quot;Sales operations leader with 8 years experience scaling B2B SaaS sales teams.&quot;
}
</code></pre>
<p><strong>Automation:</strong> New contact created in CRM → LinkedIn URL detected → AI scrapes and enriches → data written back to contact record</p>
<p><strong>Tools:</strong> <strong>Playwright</strong> for LinkedIn scraping + <strong>Claude</strong> for extraction + CRM API for write-back</p>
<h3>Workflow 4: Business Card OCR and Parsing</h3>
<p><strong>Input:</strong> Photo of business card (from mobile app or scanner)
<strong>Output:</strong> Contact record</p>
<p><strong>AI workflow:</strong></p>
<ol>
<li>OCR extracts text from image (<strong>Google Cloud Vision API</strong>, <strong>Tesseract</strong>)</li>
<li>AI parses OCR output into structured fields</li>
<li>Validation checks for duplicates</li>
<li>Write to CRM</li>
</ol>
<p><strong>AI prompt:</strong></p>
<blockquote>
<p>Parse this OCR text from a business card into contact fields. Return JSON.</p>
<p>OCR text: [paste OCR output]</p>
</blockquote>
<p><strong>Tools:</strong> Mobile upload → OCR → <strong>Claude</strong> parsing → CRM API</p>
<h2>Layer 2: Validation Logic</h2>
<p>Raw AI outputs contain errors. Validation prevents garbage data from entering the CRM.</p>
<h3>Validation 1: Duplicate Detection</h3>
<p><strong>Check:</strong> Before creating a new contact, search CRM for existing records with matching email, phone, or name+company.</p>
<p><strong>Implementation:</strong></p>
<pre><code class="language-python">def check_duplicate(email, phone, name, company):
    # Search CRM for existing contact
    existing = crm.search_contacts(email=email)
    if existing:
        return {&quot;duplicate&quot;: True, &quot;contact_id&quot;: existing.id}

    existing = crm.search_contacts(phone=phone)
    if existing:
        return {&quot;duplicate&quot;: True, &quot;contact_id&quot;: existing.id}

    existing = crm.search_contacts(name=name, company=company)
    if existing:
        return {&quot;duplicate&quot;: True, &quot;contact_id&quot;: existing.id}

    return {&quot;duplicate&quot;: False}
</code></pre>
<p><strong>Action:</strong> If duplicate found, update existing record instead of creating new one.</p>
<h3>Validation 2: Email Format Verification</h3>
<p><strong>Check:</strong> Confirm extracted email follows valid format and domain exists.</p>
<p><strong>Implementation:</strong></p>
<pre><code class="language-python">import re
import dns.resolver

def validate_email(email):
    # Regex check for valid format
    pattern = r&#39;^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$&#39;
    if not re.match(pattern, email):
        return False

    # Check if domain has MX records (mail server exists)
    domain = email.split(&#39;@&#39;)[1]
    try:
        dns.resolver.resolve(domain, &#39;MX&#39;)
        return True
    except:
        return False
</code></pre>
<p><strong>Action:</strong> Flag invalid emails for human review before CRM write.</p>
<h3>Validation 3: Phone Number Normalization</h3>
<p><strong>Check:</strong> Standardize phone formats to E.164 (+1-555-555-5555) for consistency.</p>
<p><strong>Implementation:</strong></p>
<pre><code class="language-python">import phonenumbers

def normalize_phone(phone_string, default_country=&#39;US&#39;):
    try:
        parsed = phonenumbers.parse(phone_string, default_country)
        if phonenumbers.is_valid_number(parsed):
            return phonenumbers.format_number(parsed, phonenumbers.PhoneNumberFormat.E164)
        else:
            return None
    except:
        return None
</code></pre>
<p><strong>Action:</strong> Reject or flag phone numbers that can&#39;t be parsed.</p>
<h3>Validation 4: Company Name Standardization</h3>
<p><strong>Check:</strong> AI extracts &quot;Acme Inc&quot;, &quot;Acme, Inc.&quot;, &quot;ACME INC&quot; as different companies. Standardize to canonical form.</p>
<p><strong>Implementation:</strong></p>
<pre><code class="language-python">def standardize_company_name(name):
    # Remove legal entity suffixes for matching
    suffixes = [&#39;Inc.&#39;, &#39;Inc&#39;, &#39;LLC&#39;, &#39;Ltd.&#39;, &#39;Corporation&#39;, &#39;Corp.&#39;, &#39;Corp&#39;]
    clean_name = name
    for suffix in suffixes:
        clean_name = clean_name.replace(suffix, &#39;&#39;).strip()

    # Search CRM for existing company with similar name (fuzzy match)
    existing = crm.search_companies(name=clean_name, fuzzy=True)
    if existing:
        return existing.canonical_name
    else:
        return name
</code></pre>
<p><strong>Action:</strong> Link contacts to existing company records instead of creating duplicates.</p>
<h3>Validation 5: Confidence Scoring</h3>
<p><strong>Check:</strong> AI assigns confidence scores to each extracted field. Low-confidence fields are flagged for human review.</p>
<p><strong>AI prompt addition:</strong></p>
<blockquote>
<p>For each field, include a confidence score (0-100) indicating certainty. If confidence &lt; 70 for any field, include a &quot;needs_review&quot; flag.</p>
</blockquote>
<p><strong>Example output:</strong></p>
<pre><code class="language-json">{
  &quot;first_name&quot;: &quot;Sarah&quot;,
  &quot;first_name_confidence&quot;: 95,
  &quot;title&quot;: &quot;VP of Marketing&quot;,
  &quot;title_confidence&quot;: 85,
  &quot;company&quot;: &quot;Acme SaaS Inc.&quot;,
  &quot;company_confidence&quot;: 60,
  &quot;needs_review&quot;: true,
  &quot;review_reason&quot;: &quot;Company name extracted from ambiguous context&quot;
}
</code></pre>
<p><strong>Action:</strong> Records with <code>needs_review: true</code> go to human validation queue before CRM write.</p>
<h2>Layer 3: CRM Write Operations</h2>
<p>Validated data must be written to the CRM. Two methods: API integration (preferred) or browser automation (fallback).</p>
<h3>Method 1: API Integration (Preferred)</h3>
<p>Most modern CRMs expose APIs for creating and updating records.</p>
<p><strong>HubSpot example (create contact):</strong></p>
<pre><code class="language-python">import requests

def create_hubspot_contact(data):
    url = &quot;https://api.hubapi.com/crm/v3/objects/contacts&quot;
    headers = {
        &quot;Authorization&quot;: f&quot;Bearer {HUBSPOT_API_KEY}&quot;,
        &quot;Content-Type&quot;: &quot;application/json&quot;
    }
    payload = {
        &quot;properties&quot;: {
            &quot;email&quot;: data[&quot;email&quot;],
            &quot;firstname&quot;: data[&quot;first_name&quot;],
            &quot;lastname&quot;: data[&quot;last_name&quot;],
            &quot;jobtitle&quot;: data[&quot;title&quot;],
            &quot;company&quot;: data[&quot;company&quot;],
            &quot;phone&quot;: data[&quot;phone&quot;]
        }
    }
    response = requests.post(url, json=payload, headers=headers)
    return response.json()
</code></pre>
<p><strong>Salesforce example (update contact):</strong></p>
<pre><code class="language-python">from simple_salesforce import Salesforce

sf = Salesforce(username=&#39;user&#39;, password=&#39;pass&#39;, security_token=&#39;token&#39;)

def update_salesforce_contact(contact_id, data):
    sf.Contact.update(contact_id, {
        &#39;Title&#39;: data[&#39;title&#39;],
        &#39;Phone&#39;: data[&#39;phone&#39;],
        &#39;MailingCity&#39;: data[&#39;location&#39;]
    })
</code></pre>
<p><strong>Advantages:</strong></p>
<ul>
<li>Fast, reliable, transactional</li>
<li>Error responses are structured and actionable</li>
<li>No risk of UI changes breaking automation</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Not all CRMs have comprehensive APIs</li>
<li>API rate limits require throttling</li>
<li>Complex workflows (multi-object updates) can be difficult to implement</li>
</ul>
<h3>Method 2: Browser Automation (Fallback)</h3>
<p>For CRMs without APIs (or with incomplete APIs), browser automation using <strong>Playwright</strong> or <strong>Selenium</strong> can replicate human data entry.</p>
<p><strong>Example: Automated contact creation in Follow Up Boss</strong></p>
<pre><code class="language-python">from playwright.sync_api import sync_playwright

def create_fub_contact(data):
    with sync_playwright() as p:
        browser = p.chromium.launch(headless=True)
        page = browser.new_page()

        # Login
        page.goto(&#39;https://app.followupboss.com/login&#39;)
        page.fill(&#39;input[name=&quot;email&quot;]&#39;, FUB_EMAIL)
        page.fill(&#39;input[name=&quot;password&quot;]&#39;, FUB_PASSWORD)
        page.click(&#39;button[type=&quot;submit&quot;]&#39;)
        page.wait_for_load_state(&#39;networkidle&#39;)

        # Navigate to create contact
        page.goto(&#39;https://app.followupboss.com/contacts/new&#39;)

        # Fill form
        page.fill(&#39;input[name=&quot;firstName&quot;]&#39;, data[&#39;first_name&#39;])
        page.fill(&#39;input[name=&quot;lastName&quot;]&#39;, data[&#39;last_name&#39;])
        page.fill(&#39;input[name=&quot;email&quot;]&#39;, data[&#39;email&#39;])
        page.fill(&#39;input[name=&quot;phone&quot;]&#39;, data[&#39;phone&#39;])

        # Submit
        page.click(&#39;button:has-text(&quot;Save Contact&quot;)&#39;)
        page.wait_for_load_state(&#39;networkidle&#39;)

        browser.close()
</code></pre>
<p><strong>Advantages:</strong></p>
<ul>
<li>Works for any web-based CRM</li>
<li>Can automate complex multi-step workflows</li>
<li>Handles edge cases that APIs don&#39;t support</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Fragile (UI changes break automation)</li>
<li>Slower than API calls</li>
<li>Requires maintaining browser session state</li>
</ul>
<h2>Error Handling and Monitoring</h2>
<p>Automated systems fail. Robust error handling prevents silent data corruption.</p>
<h3>Error Pattern 1: API Rate Limiting</h3>
<p><strong>Symptom:</strong> CRM API returns 429 Too Many Requests
<strong>Handling:</strong> Implement exponential backoff and retry logic</p>
<pre><code class="language-python">import time

def api_call_with_retry(func, max_retries=5):
    for attempt in range(max_retries):
        try:
            return func()
        except RateLimitError:
            wait_time = 2 ** attempt  # 1s, 2s, 4s, 8s, 16s
            time.sleep(wait_time)
    raise Exception(&quot;Max retries exceeded&quot;)
</code></pre>
<h3>Error Pattern 2: Validation Failure</h3>
<p><strong>Symptom:</strong> Extracted data fails validation (invalid email, missing required field)
<strong>Handling:</strong> Log to review queue, alert human operator</p>
<pre><code class="language-python">def process_contact(data):
    validation = validate_contact_data(data)
    if not validation[&#39;valid&#39;]:
        log_to_review_queue(data, validation[&#39;errors&#39;])
        send_slack_alert(f&quot;Contact validation failed: {validation[&#39;errors&#39;]}&quot;)
        return False
    else:
        create_crm_contact(data)
        return True
</code></pre>
<h3>Error Pattern 3: Duplicate Creation</h3>
<p><strong>Symptom:</strong> Automation creates duplicate contact because duplicate detection failed
<strong>Handling:</strong> Implement post-creation deduplication sweep</p>
<pre><code class="language-python">def daily_dedup_sweep():
    duplicates = crm.find_duplicate_contacts()
    for dup_group in duplicates:
        # Merge duplicates, keeping most complete record
        primary = select_primary_record(dup_group)
        for secondary in dup_group:
            if secondary.id != primary.id:
                crm.merge_contacts(primary.id, secondary.id)
</code></pre>
<h3>Error Pattern 4: AI Hallucination</h3>
<p><strong>Symptom:</strong> AI fabricates data (invents phone numbers, makes up company names)
<strong>Handling:</strong> Confidence scoring + human review for low-confidence extractions</p>
<pre><code class="language-python">if data[&#39;confidence&#39;] &lt; 70:
    queue_for_human_review(data)
else:
    create_crm_contact(data)
</code></pre>
<h2>Production Implementation: End-to-End Workflow</h2>
<p><strong>Step 1:</strong> Email arrives from new prospect
<strong>Step 2:</strong> Gmail filter forwards to automation webhook
<strong>Step 3:</strong> AI extracts contact info from signature
<strong>Step 4:</strong> Validation checks email, phone, duplicate status
<strong>Step 5:</strong> If validation passes and confidence &gt; 70, create contact via API
<strong>Step 6:</strong> If validation fails or confidence &lt; 70, log to review queue in Airtable
<strong>Step 7:</strong> Human reviews queue daily, approves or corrects flagged records
<strong>Step 8:</strong> Approved records are batch-written to CRM</p>
<p><strong>Tools stack:</strong></p>
<ul>
<li><strong>Gmail API</strong> (email trigger)</li>
<li><strong>Claude API</strong> (extraction)</li>
<li><strong>Custom Python validation</strong> (phone, email, duplicate checks)</li>
<li><strong>HubSpot API</strong> (CRM write)</li>
<li><strong>Airtable</strong> (review queue)</li>
<li><strong>Slack</strong> (error alerts)</li>
<li><strong>n8n</strong> or <strong>Make</strong> (workflow orchestration)</li>
</ul>
<h2>ROI Calculation</h2>
<p><strong>Before automation:</strong></p>
<ul>
<li>Sales team: 5 reps</li>
<li>Manual data entry: 10 hours/week per rep = 50 hours/week total</li>
<li>Fully-loaded rep cost: $75/hour</li>
<li>Monthly cost: 50 hours/week × 4 weeks × $75 = $15,000</li>
</ul>
<p><strong>After automation:</strong></p>
<ul>
<li>Automation handles 85% of data entry</li>
<li>Human review required: 7.5 hours/week (flagged cases only)</li>
<li>Monthly cost: 7.5 hours/week × 4 weeks × $75 = $2,250</li>
<li><strong>Monthly savings: $12,750</strong></li>
</ul>
<p><strong>Implementation cost:</strong></p>
<ul>
<li>Development: 40 hours @ $150/hour = $6,000 (one-time)</li>
<li>Monthly AI API costs: ~$200</li>
<li>Monthly tool costs (n8n, Airtable): ~$100</li>
<li><strong>Payback period: &lt;1 month</strong></li>
</ul>
<h2>FAQ</h2>
<h3>What if my CRM doesn&#39;t have an API?</h3>
<p>Use browser automation with <strong>Playwright</strong>. It&#39;s slower and more fragile than API integration, but it works for any web-based CRM. Budget extra time for maintenance when the CRM UI changes.</p>
<h3>How do I handle fields that AI can&#39;t extract reliably?</h3>
<p>Leave them blank or mark as &quot;AI-incomplete&quot; in a custom field. Train your team to fill these during normal CRM usage. Don&#39;t let AI guess — blank is better than wrong.</p>
<h3>Can AI update existing contacts or only create new ones?</h3>
<p>Both. For updates, implement duplicate detection (match by email or ID), then use API update methods instead of create methods. Browser automation can navigate to existing contact pages and edit fields.</p>
<h3>What&#39;s the biggest risk in CRM automation?</h3>
<p>Data corruption from undetected errors. A bug that writes phone numbers to email fields or merges unrelated contacts can destroy CRM data quality. Always implement validation layers and test thoroughly before production deployment.</p>
<h3>Should I automate everything or keep some manual data entry?</h3>
<p>Automate high-volume, low-complexity tasks (email signature extraction, transcript logging). Keep human oversight for complex judgment calls (deal stage classification, lead scoring). Aim for 80% automation, 20% human judgment.</p>

            </div>
        </article>

        <!-- Back link -->
        <div class="mt-16 pt-8 border-t border-zinc-800/60">
            <a href="/articles.html" class="text-amber-500 hover:text-amber-400 font-medium transition-colors">&larr; All articles</a>
        </div>

        <!-- CTA -->
        <div class="mt-12 bg-[#171717] border border-zinc-800 rounded-xl p-8">
          <h3 class="text-xl font-display font-600 text-[#fafafa] mb-3">Need this implemented?</h3>
          <p class="text-zinc-400 text-sm mb-6 max-w-lg">I build the search infrastructure behind mid-market B2B growth. If you want these systems running inside your company, not just on your reading list.</p>
          <a href="/services.html#contact" class="inline-block px-6 py-3 bg-amber-600 hover:bg-amber-500 text-white font-semibold rounded-lg transition-colors text-sm">Work With Me</a>
        </div>
    </main>


  <footer class="border-t border-zinc-800/60 bg-[#0a0a0a] pt-16 pb-8">
    <div class="max-w-6xl mx-auto px-6">
      <div class="grid grid-cols-2 md:grid-cols-4 gap-10 mb-14">

        <!-- Col 1: About Victor -->
        <div class="col-span-2 md:col-span-1">
          <div class="flex items-center gap-2 mb-4">
            <span class="font-display font-700 text-lg text-amber-500">b2bvic</span>
          </div>
          <p class="text-sm text-zinc-500 leading-relaxed mb-4">Victor Valentine Romo. Fractional SEO leadership and AI knowledge systems for mid-market B2B companies.</p>
          <a href="/services.html#contact" class="inline-block px-4 py-2 text-sm font-semibold bg-amber-600 hover:bg-amber-500 text-white rounded-md transition-colors">Work With Me</a>
        </div>

        <!-- Col 2: Popular Articles -->
        <div>
          <p class="text-xs text-zinc-600 uppercase tracking-wider mb-4 font-semibold">Writing</p>
          <ul class="space-y-2 text-sm">
            <li><a href="/articles/why-fractional-seo-beats-agencies.html" class="text-zinc-400 hover:text-white transition-colors">Fractional vs Agencies</a></li>
            <li><a href="/articles/why-your-seo-audit-failed.html" class="text-zinc-400 hover:text-white transition-colors">Why SEO Audits Fail</a></li>
            <li><a href="/articles/enterprise-seo-audit-4-hour-framework.html" class="text-zinc-400 hover:text-white transition-colors">4-Hour Audit Framework</a></li>
            <li><a href="/articles/ai-prompt-engineering-seo.html" class="text-zinc-400 hover:text-white transition-colors">AI Prompts for SEO</a></li>
            <li><a href="/articles/local-llm-deployment-enterprise-marketing.html" class="text-zinc-400 hover:text-white transition-colors">Local LLM Deployment</a></li>
            <li><a href="/articles/observer-protocol-ai-content-voice-homogenization.html" class="text-zinc-400 hover:text-white transition-colors">Observer Protocol</a></li>
            <li><a href="/articles/saas-seo-url-architecture-subdomains-subdirectories.html" class="text-zinc-400 hover:text-white transition-colors">SaaS URL Architecture</a></li>
            <li><a href="/articles.html" class="text-amber-500 hover:text-amber-400 transition-colors font-medium">All articles &rarr;</a></li>
          </ul>
        </div>

        <!-- Col 3: Services -->
        <div>
          <p class="text-xs text-zinc-600 uppercase tracking-wider mb-4 font-semibold">Services</p>
          <ul class="space-y-2 text-sm">
            <li><a href="/services.html#fractional" class="text-zinc-400 hover:text-white transition-colors">Fractional SEO ($8K/mo)</a></li>
            <li><a href="/services.html#knowledge" class="text-zinc-400 hover:text-white transition-colors">AI Knowledge Systems ($5K)</a></li>
            <li><a href="/services.html#sites" class="text-zinc-400 hover:text-white transition-colors">Site Builds ($5K+)</a></li>
            <li><a href="/services.html#consulting" class="text-zinc-400 hover:text-white transition-colors">Consulting ($200/hr)</a></li>
            <li><a href="/about.html" class="text-zinc-400 hover:text-white transition-colors">About</a></li>
            <li><a href="/case-studies.html" class="text-zinc-400 hover:text-white transition-colors">Case Studies</a></li>
          </ul>
        </div>

        <!-- Col 4: Network -->
        <div>
          <p class="text-xs text-zinc-600 uppercase tracking-wider mb-4 font-semibold">Network</p>
          <ul class="space-y-2 text-sm">
            <li><a href="https://scalewithsearch.com" target="_blank" rel="me" class="text-zinc-400 hover:text-white transition-colors">Scale With Search</a></li>
            <li><a href="https://aifirstsearch.com" target="_blank" rel="me" class="text-zinc-400 hover:text-white transition-colors">AI First Search</a></li>
            <li><a href="https://browserprompt.com" target="_blank" rel="me" class="text-zinc-400 hover:text-white transition-colors">Browser Prompt</a></li>
            <li><a href="https://polytraffic.com" target="_blank" rel="me" class="text-zinc-400 hover:text-white transition-colors">Polytraffic</a></li>
            <li><a href="https://victorvalentineromo.com" target="_blank" rel="me" class="text-zinc-400 hover:text-white transition-colors">Victor Valentine Romo</a></li>
            <li><a href="https://seobyrole.com" target="_blank" rel="me" class="text-zinc-400 hover:text-white transition-colors">SEO By Role</a></li>
          </ul>
        </div>
      </div>

      <!-- Bottom bar -->
      <div class="pt-8 border-t border-zinc-800/60 flex flex-col md:flex-row items-center justify-between gap-4">
        <p class="text-xs text-zinc-700">&copy; 2026 Victor Valentine Romo. All rights reserved.</p>
        <p class="text-xs text-zinc-700">A <a href="https://scalewithsearch.com" target="_blank" class="text-zinc-500 hover:text-amber-500 transition-colors">Scale With Search</a> property.</p>
      </div>
    </div>
  </footer>


  <script>
    // Mega menu
    (function() {
      const triggers = document.querySelectorAll('.mega-trigger');
      const panels = document.querySelectorAll('.mega-panel');
      let closeTimeout = null;

      function openPanel(id) {
        clearTimeout(closeTimeout);
        panels.forEach(p => p.classList.add('hidden'));
        triggers.forEach(t => t.setAttribute('aria-expanded', 'false'));
        const panel = document.getElementById('mega-' + id);
        const trigger = document.querySelector('[data-mega="' + id + '"] .mega-trigger');
        if (panel) panel.classList.remove('hidden');
        if (trigger) trigger.setAttribute('aria-expanded', 'true');
      }

      function scheduleClose() {
        closeTimeout = setTimeout(() => {
          panels.forEach(p => p.classList.add('hidden'));
          triggers.forEach(t => t.setAttribute('aria-expanded', 'false'));
        }, 200);
      }

      function cancelClose() { clearTimeout(closeTimeout); }

      triggers.forEach(btn => {
        const wrapper = btn.closest('[data-mega]');
        const id = wrapper.getAttribute('data-mega');
        btn.addEventListener('mouseenter', () => openPanel(id));
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const panel = document.getElementById('mega-' + id);
          if (panel && !panel.classList.contains('hidden')) {
            panel.classList.add('hidden');
            btn.setAttribute('aria-expanded', 'false');
          } else {
            openPanel(id);
          }
        });
        wrapper.addEventListener('mouseleave', scheduleClose);
      });

      panels.forEach(panel => {
        panel.addEventListener('mouseenter', cancelClose);
        panel.addEventListener('mouseleave', scheduleClose);
      });

      document.addEventListener('click', (e) => {
        if (!e.target.closest('[data-mega]') && !e.target.closest('.mega-panel')) {
          panels.forEach(p => p.classList.add('hidden'));
          triggers.forEach(t => t.setAttribute('aria-expanded', 'false'));
        }
      });

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          panels.forEach(p => p.classList.add('hidden'));
          triggers.forEach(t => t.setAttribute('aria-expanded', 'false'));
        }
      });
    })();

    // Mobile menu
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuIcon = document.getElementById('menu-icon');
    const closeIcon = document.getElementById('close-icon');
    if (mobileMenuBtn) {
      mobileMenuBtn.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
        menuIcon.classList.toggle('hidden');
        closeIcon.classList.toggle('hidden');
      });
    }

    // Mobile accordion sections
    document.querySelectorAll('.mobile-section-toggle').forEach(btn => {
      btn.addEventListener('click', () => {
        const section = btn.nextElementSibling;
        const chevron = btn.querySelector('svg');
        section.classList.toggle('hidden');
        chevron.style.transform = section.classList.contains('hidden') ? '' : 'rotate(180deg)';
      });
    });

    // Self-link neutralizer
    (function() {
      const currentPath = window.location.pathname.replace(/\.html$/, '').replace(/\/$/, '') || '/';
      document.querySelectorAll('a[href]').forEach(a => {
        const href = a.getAttribute('href').replace(/\.html$/, '').replace(/\/$/, '') || '/';
        if (href === currentPath) {
          a.removeAttribute('href');
          a.setAttribute('aria-current', 'page');
          a.style.opacity = '0.5';
          a.style.pointerEvents = 'none';
        }
      });
    })();
  </script>

</body>
</html>